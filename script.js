// Questions database - 100+ challenging questions
const questionsDatabase = {
    "harsh_reality": [
        "Why are you still making the same mistakes you made five years ago?",
        "What excuse do you keep telling yourself that's actually just laziness?",
        "How many opportunities have you missed because you were too comfortable?",
        "What would you think of yourself if you met you for the first time?",
        "Are you really growing or just getting older?",
        "How many times have you said 'tomorrow' this week?",
        "What's the real reason you're not where you want to be?",
        "How much of your potential are you actually using?",
        "What would your 10-year-old self think of you now?",
        "Why do you keep choosing easy over important?",
        "How many dreams have you killed with 'maybe later'?",
        "What's the price you're paying for staying safe?",
        "When did you stop believing you could change?",
        "How many people have you let down by not trying?",
        "What's the difference between busy and productive?"
    ],
    "brutal_honesty": [
        "What's the biggest lie you tell yourself daily?",
        "How much time do you waste on things that don't matter?",
        "What are you avoiding that you know you should face?",
        "Why do you care more about what strangers think than what you think?",
        "What's the real reason you haven't achieved your biggest goal?",
        "How many times have you quit when it got hard?",
        "What's the ugliest truth about yourself?",
        "Why do you expect others to respect you when you don't respect yourself?",
        "What's the most embarrassing thing about your current situation?",
        "How many promises to yourself have you broken this year?",
        "What's the real reason you're not happy?",
        "Why do you blame circumstances instead of taking responsibility?",
        "What's the worst thing you've done to yourself?",
        "How much of your life is fake?",
        "What's the truth you're most afraid to admit?"
    ],
    "confrontational": [
        "When was the last time you actually challenged yourself instead of taking the easy way?",
        "What makes you think you deserve better when you're not doing better?",
        "How long are you going to blame others for your problems?",
        "What's stopping you from being the person you pretend to be online?",
        "Why do you expect others to change when you won't change yourself?",
        "What makes you think you're special when you're not doing anything special?",
        "How long will you keep making the same excuses?",
        "What's the real reason you're not successful?",
        "Why do you think you deserve respect when you don't earn it?",
        "How many times have you given up on yourself?",
        "What's stopping you from being great?",
        "Why do you expect others to believe in you when you don't believe in yourself?",
        "How long will you keep settling for less?",
        "What makes you think you're better than you actually are?",
        "Why do you think you're entitled to success without effort?"
    ],
    "self_judgment": [
        "What's the worst thing about your personality that you refuse to admit?",
        "How many times have you given up on something important this year?",
        "What would your enemies say about you that's actually true?",
        "Are you living your life or just waiting for it to happen?",
        "What's the most selfish thing you've done recently?",
        "What's the most pathetic thing about your current situation?",
        "How many people have you disappointed by not being better?",
        "What's the worst decision you've made this year?",
        "How many times have you chosen comfort over growth?",
        "What's the most embarrassing thing about your habits?",
        "How many opportunities have you wasted?",
        "What's the worst thing you've done to someone you love?",
        "How many times have you failed to keep your word?",
        "What's the most shameful thing about your behavior?",
        "How many dreams have you abandoned?"
    ],
    "reality_check": [
        "What's the difference between who you are and who you think you are?",
        "How much of your life is spent on autopilot?",
        "What's the price you're paying for staying in your comfort zone?",
        "Why do you keep making promises to yourself that you don't keep?",
        "What's the hardest truth about yourself that you need to accept?",
        "How much of your success is actually luck?",
        "What's the real reason people don't respect you?",
        "How much of your confidence is fake?",
        "What's the difference between your online persona and real life?",
        "How much of your happiness is dependent on others?",
        "What's the real reason you're not where you want to be?",
        "How much of your life is controlled by fear?",
        "What's the difference between being busy and being productive?",
        "How much of your potential are you wasting?",
        "What's the real reason you're not achieving your goals?"
    ],
    "provocative": [
        "What would happen if you stopped making excuses for one month?",
        "How many people have you disappointed because you were too scared to try?",
        "What's the real reason you're not where you want to be in life?",
        "Why do you think you're special when you're not doing anything special?",
        "What's the biggest risk you're avoiding that could change everything?",
        "What would happen if you actually tried for once?",
        "How many times have you chosen the easy way out?",
        "What's the real reason you're not successful?",
        "Why do you think you deserve better when you're not doing better?",
        "What would happen if you stopped blaming others?",
        "How many dreams have you killed with doubt?",
        "What's the real reason you're not happy?",
        "Why do you think you're entitled to success?",
        "What would happen if you actually committed to something?",
        "How many times have you given up when it got hard?"
    ],
    "uncomfortable_truths": [
        "What's the most uncomfortable truth about your relationships?",
        "How many times have you chosen yourself over others?",
        "What's the real reason you're not loved the way you want to be?",
        "How much of your life is spent trying to impress people who don't matter?",
        "What's the most selfish thing you've done to someone you love?",
        "How many times have you used others for your own benefit?",
        "What's the real reason you're not trusted?",
        "How much of your kindness is actually manipulation?",
        "What's the most hurtful thing you've done to someone?",
        "How many times have you betrayed someone's trust?",
        "What's the real reason you're not respected?",
        "How much of your success came at someone else's expense?",
        "What's the most dishonest thing you've done recently?",
        "How many times have you taken credit for someone else's work?",
        "What's the real reason people don't want to be around you?"
    ],
    "failure_analysis": [
        "What's the biggest failure you're still making excuses for?",
        "How many times have you failed because you didn't try hard enough?",
        "What's the real reason you keep failing at the same things?",
        "How many opportunities have you lost because of your attitude?",
        "What's the most embarrassing way you've failed recently?",
        "How many times have you failed because you were too proud to ask for help?",
        "What's the real reason you're not learning from your failures?",
        "How many times have you failed because you gave up too early?",
        "What's the most costly failure you've had this year?",
        "How many times have you failed because you didn't prepare?",
        "What's the real reason you're not improving?",
        "How many times have you failed because you were too scared?",
        "What's the most avoidable failure you've had?",
        "How many times have you failed because you didn't believe in yourself?",
        "What's the real reason you're not succeeding?"
    ],
    "time_waste": [
        "How much of your life have you wasted on things that don't matter?",
        "What's the biggest time waster you're still doing?",
        "How many hours have you lost to social media this week?",
        "What's the real reason you're not using your time better?",
        "How much of your day is spent avoiding what you should be doing?",
        "What's the most pointless thing you do regularly?",
        "How many years have you wasted on the wrong priorities?",
        "What's the real reason you're not making progress?",
        "How much of your time is spent on things that won't matter in 5 years?",
        "What's the biggest distraction you're still allowing?",
        "How many opportunities have you missed because you were too busy?",
        "What's the real reason you're not achieving your goals?",
        "How much of your life is spent on autopilot?",
        "What's the most wasteful thing you do with your time?",
        "How many dreams have you delayed because of poor time management?"
    ],
    "fear_confrontation": [
        "What's the biggest fear that's controlling your life?",
        "How many times have you let fear stop you from doing something important?",
        "What's the real reason you're not taking risks?",
        "How much of your life is controlled by fear?",
        "What's the most irrational fear you're still holding onto?",
        "How many opportunities have you missed because you were too scared?",
        "What's the real reason you're not living your dreams?",
        "How much of your potential is locked away by fear?",
        "What's the biggest risk you're avoiding that could change everything?",
        "How many times have you chosen safety over growth?",
        "What's the real reason you're not happy?",
        "How much of your life is spent avoiding discomfort?",
        "What's the most limiting belief you have about yourself?",
        "How many dreams have you killed with fear?",
        "What's the real reason you're not successful?"
    ]
};

class MotivationalApp {
    constructor() {
        this.currentQuestion = null;
        this.currentCategory = null;
        this.timer = null;
        this.timerInterval = 15000; // 15 seconds default
        this.answeredCount = 0;
        this.isFullscreen = false;
        this.isDarkTheme = false;
        
        this.initializeApp();
        this.bindEvents();
        this.loadStats();
    }

    initializeApp() {
        this.allQuestions = this.flattenQuestions();
        this.shuffleQuestion();
        this.updateStats();
        this.setupTimer();
    }

    flattenQuestions() {
        const flat = [];
        Object.keys(questionsDatabase).forEach(category => {
            questionsDatabase[category].forEach(question => {
                flat.push({ question, category });
            });
        });
        return flat;
    }

    shuffleQuestion() {
        const randomIndex = Math.floor(Math.random() * this.allQuestions.length);
        const selected = this.allQuestions[randomIndex];
        
        this.currentQuestion = selected.question;
        this.currentCategory = selected.category;
        
        this.displayQuestion();
        this.checkForPreviousAnswer();
    }

    displayQuestion() {
        document.getElementById('category').textContent = this.currentCategory;
        document.getElementById('question').textContent = this.currentQuestion;
        
        const questionIndex = this.allQuestions.findIndex(q => q.question === this.currentQuestion);
        document.getElementById('question-number').textContent = `Question ${questionIndex + 1} of ${this.allQuestions.length}`;
        
        // Update fullscreen question if in fullscreen mode
        if (this.isFullscreen) {
            document.getElementById('fullscreen-question').textContent = this.currentQuestion;
        }
        
        // Hide answer sections
        document.getElementById('answer-section').style.display = 'none';
        document.getElementById('previous-answer').style.display = 'none';
        document.getElementById('show-answer-btn').style.display = 'none';
    }

    checkForPreviousAnswer() {
        const answers = this.getAnswers();
        const previousAnswer = answers[this.currentQuestion];
        
        if (previousAnswer) {
            document.getElementById('show-answer-btn').style.display = 'inline-block';
        }
    }

    bindEvents() {
        // Shuffle button
        document.getElementById('shuffle-btn').addEventListener('click', () => {
            this.shuffleQuestion();
            this.resetTimer();
        });

        // Answer button
        document.getElementById('answer-btn').addEventListener('click', () => {
            this.showAnswerSection();
        });

        // Show previous answer button
        document.getElementById('show-answer-btn').addEventListener('click', () => {
            this.showPreviousAnswer();
        });

        // Save answer button
        document.getElementById('save-answer-btn').addEventListener('click', () => {
            this.saveAnswer();
        });

        // Cancel answer button
        document.getElementById('cancel-answer-btn').addEventListener('click', () => {
            this.hideAnswerSection();
        });

        // Add new answer button
        document.getElementById('add-new-answer-btn').addEventListener('click', () => {
            this.showAnswerSection();
        });

        // Timer setting change
        document.getElementById('timer').addEventListener('change', (e) => {
            this.timerInterval = parseInt(e.target.value) * 1000;
            this.setupTimer();
        });

        // Fullscreen button
        document.getElementById('fullscreen-btn').addEventListener('click', () => {
            this.toggleFullscreen();
        });

        // Theme toggle button
        document.getElementById('theme-toggle').addEventListener('click', () => {
            this.toggleTheme();
        });

        // Click on fullscreen overlay to shuffle question
        document.getElementById('fullscreen-overlay').addEventListener('click', () => {
            if (this.isFullscreen) {
                this.shuffleQuestion();
            }
        });

        // Double-click on fullscreen overlay to exit
        document.getElementById('fullscreen-overlay').addEventListener('dblclick', () => {
            if (this.isFullscreen) {
                this.exitFullscreen();
            }
        });
    }

    showAnswerSection() {
        document.getElementById('answer-section').style.display = 'block';
        document.getElementById('previous-answer').style.display = 'none';
        document.getElementById('answer-input').focus();
    }

    showPreviousAnswer() {
        const answers = this.getAnswers();
        const previousAnswer = answers[this.currentQuestion];
        
        if (previousAnswer) {
            document.getElementById('answer-content').textContent = previousAnswer.answer;
            document.getElementById('answer-date').textContent = `Answered on ${new Date(previousAnswer.date).toLocaleDateString()}`;
            document.getElementById('previous-answer').style.display = 'block';
            document.getElementById('answer-section').style.display = 'none';
        }
    }

    hideAnswerSection() {
        document.getElementById('answer-section').style.display = 'none';
        document.getElementById('answer-input').value = '';
    }

    saveAnswer() {
        const answerText = document.getElementById('answer-input').value.trim();
        
        if (!answerText) {
            alert('Please enter an answer before saving.');
            return;
        }

        const answers = this.getAnswers();
        const existingAnswer = answers[this.currentQuestion];
        
        if (existingAnswer) {
            // Add new answer alongside existing one
            if (!answers[this.currentQuestion].additionalAnswers) {
                answers[this.currentQuestion].additionalAnswers = [];
            }
            answers[this.currentQuestion].additionalAnswers.push({
                answer: answerText,
                date: new Date().toISOString()
            });
        } else {
            // First answer
            answers[this.currentQuestion] = {
                answer: answerText,
                date: new Date().toISOString(),
                additionalAnswers: []
            };
            this.answeredCount++;
        }

        this.saveAnswers(answers);
        this.updateStats();
        this.hideAnswerSection();
        
        // Show the saved answer
        this.showPreviousAnswer();
    }

    getAnswers() {
        const saved = localStorage.getItem('motivationalAnswers');
        return saved ? JSON.parse(saved) : {};
    }

    saveAnswers(answers) {
        localStorage.setItem('motivationalAnswers', JSON.stringify(answers));
    }

    loadStats() {
        const answers = this.getAnswers();
        this.answeredCount = Object.keys(answers).length;
    }

    updateStats() {
        document.getElementById('answered-count').textContent = this.answeredCount;
        document.getElementById('total-count').textContent = this.allQuestions.length;
    }

    setupTimer() {
        this.clearTimer();
        
        if (this.timerInterval > 0) {
            this.timer = setInterval(() => {
                this.shuffleQuestion();
            }, this.timerInterval);
        }
    }

    clearTimer() {
        if (this.timer) {
            clearInterval(this.timer);
            this.timer = null;
        }
    }

    resetTimer() {
        this.clearTimer();
        this.setupTimer();
    }

    toggleFullscreen() {
        this.isFullscreen = !this.isFullscreen;
        const overlay = document.getElementById('fullscreen-overlay');
        
        if (this.isFullscreen) {
            overlay.classList.add('active');
            if (this.isDarkTheme) {
                overlay.classList.add('dark');
            }
            // Set the current question in fullscreen
            document.getElementById('fullscreen-question').textContent = this.currentQuestion;
        } else {
            overlay.classList.remove('active');
            overlay.classList.remove('dark');
        }
    }

    exitFullscreen() {
        this.isFullscreen = false;
        const overlay = document.getElementById('fullscreen-overlay');
        overlay.classList.remove('active');
        overlay.classList.remove('dark');
    }

    toggleTheme() {
        this.isDarkTheme = !this.isDarkTheme;
        const body = document.body;
        const overlay = document.getElementById('fullscreen-overlay');
        const themeBtn = document.getElementById('theme-toggle');
        
        if (this.isDarkTheme) {
            body.classList.add('dark-theme');
            if (this.isFullscreen) {
                overlay.classList.add('dark');
            }
            themeBtn.textContent = 'Light Mode';
        } else {
            body.classList.remove('dark-theme');
            overlay.classList.remove('dark');
            themeBtn.textContent = 'Dark Mode';
        }
    }
}

// Initialize the app when the page loads
document.addEventListener('DOMContentLoaded', () => {
    new MotivationalApp();
});
